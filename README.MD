# Лог-парсер для обработки финансовых операций

Приложение для анализа логов финансовых операций пользователей (пополнение, перевод, снятие) и формирования итогового баланса.

## Особенности

- Парсинг логов в формате: `[timestamp] user операция сумма [доп. параметры]`
- Поддержка операций: 
  - `balance` - запрос баланса
  - `withdrew` - снятие средств
  - `transferred` - перевод другому пользователю
- Автоматическое создание записей типа `RECEIVED` для получателей переводов
- Генерация отдельных файлов с историей операций для каждого пользователя
- Расчет финального баланса

## Требования

- Java 17 или выше

## Сборка и запуск

1. Скомпилировать проект:

   ```bash
   javac -d out -sourcepath src/main/java src/main/java/ru/logger/App.java
   ```
   
    или

    ```bash
    mvn clean && mvn install
    ```

2. Запуск:

   ```bash
   java -cp out ru.logger.App <путь_к_директории_с_логами>
   ```
   
    или

    ```bash
    mvn exec:java -Dexec.mainClass="ru.logger.App" -Dexec.args="<путь_к_директории_с_логами>"
    ```    

Результаты будут сохранены в поддиректорию `transactions_by_users`.

## Формат входных данных

Пример валидных записей в лог-файлах (расширение `.log`):
```
[2023-10-05 14:30:00] user1 balance is 1500.00
[2023-10-05 14:35:00] user2 withdrew 500.00
[2023-10-05 14:40:00] user1 transferred 300.00 to user2
```

## Выходные данные

Для каждого пользователя создается файл `<user>.log` в формате:
```
[timestamp] исходная запись операции
...
[текущее_время] user final balance X.XX
```

Пример файла `user1.log`:
```
[2023-10-05 14:30:00] user1 balance is 1500.00
[2023-10-05 14:40:00] user1 transferred 300.00 to user2
[2023-10-05 15:00:00] user1 final balance 1200.00
```

## Обработка ошибок

Строки, не соответствующие формату:
- Не начинаются с [timestamp]
- Содержат неизвестные операции
- Имеют некорректный формат данных

Некорректные строки игнорируются и не влияют на расчет баланса.

## Структура проекта

Основные компоненты:
- `App` - точка входа
- `LogParser` - интерфейс парсера
- `SimpleLogParser` - реализация парсера
- `TransactionService` - обработчик транзакций
- `LogEntry` - модель записи лога
- `Type` - перечень операций

## Ограничения

- Поддерживается только формат даты `yyyy-MM-dd HH:mm:ss`
- Некорректные строки не сохраняются отдельно
